<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terapia Liberal | Análisis Independiente</title>
    <meta name="description" content="Biblioteca de investigaciones. Análisis independientes sobre economía, geopolítica y filosofía liberal.">

    <!-- Preconnect -->
    <link rel="preconnect" href="https://img.youtube.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: '#d4af37',
                        'gold-light': '#e5c158',
                        'gold-dark': '#b8962e',
                    }
                }
            }
        }
    </script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <!-- ============ HEADER ============ -->
    <header class="site-header" id="site-header">
        <div class="header-inner">
            <!-- Logo -->
            <a href="/" class="logo-link">
                <img
                    src="https://yt3.ggpht.com/ZzVyDrXt4x8YWoKbISHZzC9CCtkEPCN4GRET1Xxf_wssNyw7mfN-xTbBmpwEJHO0DRQrg0Dgug=s68-c-k-c0x00ffffff-no-rj"
                    alt="Terapia Liberal"
                    class="logo-img"
                >
                <span class="logo-text">Terapia Liberal</span>
            </a>

            <!-- Nav Desktop -->
            <nav class="main-nav">
                <a href="#videos" class="nav-link" onclick="scrollToSection('videos');return false;">Videos</a>
                <a href="#articulos" class="nav-link" onclick="scrollToSection('articulos');return false;">Artículos</a>
                <a href="#newsletter" class="nav-link" onclick="scrollToSection('newsletter');return false;">Newsletter</a>
                <a href="https://www.patreon.com/terapialiberal" target="_blank" rel="noopener noreferrer" class="nav-cta">
                    <i class="fab fa-patreon mr-1"></i> Apoyar
                </a>
            </nav>

            <!-- Social + Mobile btn -->
            <div style="display:flex;align-items:center;gap:1rem;">
                <a href="https://www.youtube.com/@terapialiberal" target="_blank" rel="noopener noreferrer"
                   class="nav-link" style="font-size:1.1rem;" aria-label="YouTube">
                    <i class="fab fa-youtube"></i>
                </a>
                <a href="https://x.com/terapia_liberal" target="_blank" rel="noopener noreferrer"
                   class="nav-link" style="font-size:1.1rem;" aria-label="Twitter/X">
                    <i class="fab fa-x-twitter"></i>
                </a>
                <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Menú">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div class="mobile-menu" id="mobile-menu">
            <nav class="mobile-nav">
                <a href="#videos" class="mobile-nav-link" onclick="scrollToSection('videos');closeMobileMenu();">Videos</a>
                <a href="#articulos" class="mobile-nav-link" onclick="scrollToSection('articulos');closeMobileMenu();">Artículos</a>
                <a href="#newsletter" class="mobile-nav-link" onclick="scrollToSection('newsletter');closeMobileMenu();">Newsletter</a>
                <a href="https://www.patreon.com/terapialiberal" target="_blank" rel="noopener noreferrer" class="mobile-nav-link mobile-nav-cta">
                    <i class="fab fa-patreon mr-2"></i>Apoyar el Proyecto
                </a>
            </nav>
        </div>
    </header>

    <!-- ============ MAIN ============ -->
    <main>

        <!-- HERO -->
        <section class="hero-section">
            <div style="max-width:900px;margin:0 auto;position:relative;z-index:1;">
                <p style="color:var(--gold);font-size:0.85rem;font-weight:600;letter-spacing:0.15em;text-transform:uppercase;margin-bottom:1.5rem;">
                    Análisis Independiente
                </p>
                <h1 class="hero-title">
                    <span class="highlight">Terapia</span> Liberal
                </h1>
                <p class="hero-subtitle">
                    Investigaciones profundas sobre economía, geopolítica y filosofía liberal.<br>
                    Conectando los eventos globales con las agendas del poder.
                </p>
                <div style="display:flex;flex-wrap:wrap;gap:1rem;justify-content:center;margin-top:2.5rem;">
                    <a href="#videos" onclick="scrollToSection('videos');return false;" class="nav-cta" style="font-size:1rem;padding:0.85rem 2rem;">
                        <i class="fas fa-play mr-2"></i>Ver Videos
                    </a>
                    <a href="#articulos" onclick="scrollToSection('articulos');return false;"
                       style="font-size:1rem;padding:0.85rem 2rem;border-radius:8px;border:1px solid var(--border-gold);color:var(--gold);font-weight:600;transition:all 0.3s;text-decoration:none;">
                        Leer Artículos
                    </a>
                </div>
            </div>
        </section>

        <!-- FEATURED -->
        <section class="featured-section" id="videos">
            <div style="display:flex;align-items:center;gap:0.75rem;margin-bottom:1.5rem;">
                <span style="width:4px;height:28px;background:linear-gradient(180deg,var(--gold),var(--red));border-radius:2px;display:inline-block;"></span>
                <h2 style="font-family:'Playfair Display',serif;font-size:1.5rem;color:var(--text-white);margin:0;">
                    ⭐ Análisis Destacado
                </h2>
            </div>
            <div class="featured-card" id="featured-container">
                <!-- Skeleton -->
                <div class="featured-thumb" style="background:#111;min-height:280px;display:flex;align-items:center;justify-content:center;">
                    <i class="fas fa-spinner fa-spin" style="color:var(--gold);font-size:2rem;"></i>
                </div>
                <div class="featured-body">
                    <div style="height:20px;background:#1f1f1f;border-radius:4px;width:100px;margin-bottom:1rem;"></div>
                    <div style="height:32px;background:#1f1f1f;border-radius:4px;width:90%;margin-bottom:0.75rem;"></div>
                    <div style="height:32px;background:#1f1f1f;border-radius:4px;width:70%;margin-bottom:1.5rem;"></div>
                    <div style="height:16px;background:#1f1f1f;border-radius:4px;width:100%;margin-bottom:0.5rem;"></div>
                    <div style="height:16px;background:#1f1f1f;border-radius:4px;width:80%;"></div>
                </div>
            </div>
        </section>

        <!-- FILTERS + GRID -->
        <section style="max-width:1400px;margin:0 auto;padding:0 2rem 4rem;" id="articulos">

            <!-- Filtros -->
            <div style="display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:1rem;margin-bottom:2rem;">
                <div style="display:flex;align-items:center;gap:0.75rem;">
                    <span style="width:4px;height:28px;background:linear-gradient(180deg,var(--gold),var(--red));border-radius:2px;display:inline-block;"></span>
                    <h2 id="grilla-titulo" style="font-family:'Playfair Display',serif;font-size:1.5rem;color:var(--text-white);margin:0;">
                        Todos los Análisis
                    </h2>
                    <span id="article-count" style="color:var(--text-muted);font-size:0.85rem;"></span>
                </div>
                <div class="filter-container" style="margin:0;gap:0.5rem;">
                    <button class="filter-btn active" data-tipo="all" onclick="filterByTipo('all')">
                        <i class="fas fa-th-large mr-1"></i>Todos
                    </button>
                    <button class="filter-btn" data-tipo="video" onclick="filterByTipo('video')">
                        <i class="fab fa-youtube mr-1"></i>Videos
                    </button>
                    <button class="filter-btn" data-tipo="articulo" onclick="filterByTipo('articulo')">
                        <i class="fas fa-file-alt mr-1"></i>Artículos
                    </button>
                </div>
            </div>

            <!-- Layout: Grid + Sidebar -->
            <div style="display:grid;grid-template-columns:1fr 320px;gap:2.5rem;align-items:start;" id="main-layout">

                <!-- Content Grid -->
                <div>
                    <div class="content-grid" id="grid-container" style="padding:0;"></div>
                    <div style="text-align:center;margin-top:2rem;">
                        <button id="load-more-btn" class="nav-cta" style="display:none;font-size:0.95rem;padding:0.85rem 2rem;cursor:pointer;border:none;" onclick="loadMore()">
                            <i class="fas fa-plus mr-2"></i>Cargar más
                        </button>
                    </div>
                </div>

                <!-- Sidebar -->
                <aside style="position:sticky;top:100px;display:flex;flex-direction:column;gap:1.5rem;">

                    <!-- Buscador -->
                    <div class="sidebar">
                        <div class="section-bg" style="padding:1.5rem;">
                            <h4 style="color:var(--gold);font-weight:700;margin-bottom:1rem;font-size:1rem;">
                                <i class="fas fa-search mr-2"></i>Buscar
                            </h4>
                            <input
                                type="text"
                                id="search-input"
                                placeholder="Buscar análisis..."
                                class="newsletter-input"
                                oninput="searchArticles(this.value)"
                            >
                        </div>
                    </div>

                    <!-- Newsletter -->
                    <div class="sidebar" id="newsletter">
                        <div class="section-bg" style="padding:1.5rem;">
                            <h4 style="color:var(--gold);font-weight:700;margin-bottom:0.5rem;font-size:1rem;">
                                <i class="fas fa-envelope mr-2"></i>Newsletter
                            </h4>
                            <p style="color:var(--text-muted);font-size:0.85rem;margin-bottom:1rem;">
                                Recibí análisis nuevos cada semana.
                            </p>
                            <form name="newsletter" method="POST" data-netlify="true" onsubmit="handleNewsletter(event)">
                                <input type="hidden" name="form-name" value="newsletter">
                                <input
                                    type="email"
                                    name="email"
                                    placeholder="tu@email.com"
                                    class="newsletter-input"
                                    required
                                >
                                <button type="submit" class="nav-cta" style="width:100%;text-align:center;cursor:pointer;border:none;padding:0.75rem;font-size:0.9rem;">
                                    Suscribirse
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- Etiquetas -->
                    <div class="sidebar">
                        <div class="section-bg" style="padding:1.5rem;">
                            <h4 style="color:var(--gold);font-weight:700;margin-bottom:1rem;font-size:1rem;">
                                <i class="fas fa-tags mr-2"></i>Etiquetas
                            </h4>
                            <div id="tags-cloud" style="display:flex;flex-wrap:wrap;gap:0.4rem;"></div>
                        </div>
                    </div>

                    <!-- Archivo -->
                    <div class="sidebar">
                        <div class="section-bg" style="padding:1.5rem;">
                            <h4 style="color:var(--gold);font-weight:700;margin-bottom:1rem;font-size:1rem;">
                                <i class="fas fa-archive mr-2"></i>Archivo
                            </h4>
                            <div id="archive-list" style="max-height:280px;overflow-y:auto;"></div>
                            <button id="archive-toggle" onclick="toggleArchive()" style="display:none;color:var(--gold);background:none;border:none;cursor:pointer;font-size:0.85rem;margin-top:0.75rem;padding:0;">
                                Ver más ▼
                            </button>
                        </div>
                    </div>

                    <!-- Sobre el Autor -->
                    <div class="sidebar">
                        <div class="section-bg" style="padding:1.5rem;text-align:center;">
                            <h4 style="color:var(--gold);font-weight:700;margin-bottom:1rem;font-size:1rem;">
                                <i class="fas fa-user mr-2"></i>Sobre el Autor
                            </h4>
                            <img
                                src="https://i.postimg.cc/8C3ZkxNy/1660176107980.jpg"
                                alt="Nicolás Martínez Lage"
                                style="width:80px;height:80px;border-radius:50%;object-fit:cover;border:2px solid var(--gold);margin:0 auto 0.75rem;"
                            >
                            <h5 style="color:var(--text-white);font-weight:700;margin-bottom:0.25rem;">Nicolás Martínez Lage</h5>
                            <p style="color:var(--gold);font-size:0.8rem;font-weight:600;margin-bottom:0.75rem;">Analista Independiente</p>
                            <p style="color:var(--text-muted);font-size:0.85rem;line-height:1.6;margin:0;">
                                Creador de Terapia Liberal. Especializado en revelar las estructuras del control financiero mundial.
                            </p>
                        </div>
                    </div>

                </aside>
            </div>
        </section>

    </main>

    <!-- ============ FOOTER ============ -->
    <footer class="site-footer">
        <div class="footer-grid">
            <!-- Brand -->
            <div>
                <div class="footer-logo">
                    <img
                        src="https://yt3.ggpht.com/ZzVyDrXt4x8YWoKbISHZzC9CCtkEPCN4GRET1Xxf_wssNyw7mfN-xTbBmpwEJHO0DRQrg0Dgug=s68-c-k-c0x00ffffff-no-rj"
                        alt="Terapia Liberal"
                        class="footer-logo-img"
                    >
                    <span class="footer-logo-text">Terapia Liberal</span>
                </div>
                <p class="footer-description">
                    Análisis independiente para mentes críticas. Geopolítica, economía y filosofía liberal sin filtros.
                </p>
                <div class="footer-social" style="margin-top:1.25rem;">
                    <a href="https://www.youtube.com/@terapialiberal" target="_blank" rel="noopener noreferrer" class="social-link youtube" aria-label="YouTube">
                        <i class="fab fa-youtube"></i>
                    </a>
                    <a href="https://x.com/terapia_liberal" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="Twitter/X">
                        <i class="fab fa-x-twitter"></i>
                    </a>
                    <a href="https://www.patreon.com/terapialiberal" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="Patreon">
                        <i class="fab fa-patreon"></i>
                    </a>
                </div>
            </div>

            <!-- Navegación -->
            <div>
                <h4 class="footer-title">Navegación</h4>
                <nav class="footer-links">
                    <a href="/" class="footer-link">Inicio</a>
                    <a href="#videos" class="footer-link" onclick="scrollToSection('videos');return false;">Videos</a>
                    <a href="#articulos" class="footer-link" onclick="scrollToSection('articulos');return false;">Artículos</a>
                    <a href="#newsletter" class="footer-link" onclick="scrollToSection('newsletter');return false;">Newsletter</a>
                </nav>
            </div>

            <!-- Legal -->
            <div>
                <h4 class="footer-title">Más</h4>
                <nav class="footer-links">
                    <a href="https://www.youtube.com/@terapialiberal" target="_blank" rel="noopener noreferrer" class="footer-link">Canal YouTube</a>
                    <a href="https://www.patreon.com/terapialiberal" target="_blank" rel="noopener noreferrer" class="footer-link">Patreon</a>
                    <a href="/admin" class="footer-link">Admin CMS</a>
                </nav>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="footer-copyright">© 2026 Terapia Liberal. Análisis independiente para mentes críticas.</p>
        </div>
    </footer>

    <!-- Back to Top -->
    <button id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})" aria-label="Volver arriba">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- ============ SCRIPTS ============ -->
    <script>
        // ── Helpers ──────────────────────────────────────────────
        function scrollToSection(id) {
            const el = document.getElementById(id);
            if (el) el.scrollIntoView({ behavior: 'smooth' });
        }

        function closeMobileMenu() {
            document.getElementById('mobile-menu')?.classList.remove('open');
        }

        // Mobile menu toggle
        document.getElementById('mobile-menu-btn')?.addEventListener('click', () => {
            document.getElementById('mobile-menu')?.classList.toggle('open');
        });

        // Back to top
        window.addEventListener('scroll', () => {
            document.getElementById('backToTop').classList.toggle('show', window.pageYOffset > 400);
        });

        // Header scroll effect
        window.addEventListener('scroll', () => {
            document.getElementById('site-header')?.classList.toggle('scrolled', window.scrollY > 50);
        });

        // Newsletter
        function handleNewsletter(e) {
            e.preventDefault();
            const btn = e.target.querySelector('button[type=submit]');
            btn.textContent = '¡Gracias! ✓';
            btn.style.background = '#16a34a';
            setTimeout(() => {
                btn.textContent = 'Suscribirse';
                btn.style.background = '';
                e.target.reset();
            }, 3000);
        }

        // ── Data & State ─────────────────────────────────────────
        let allArticles = [];
        let filteredArticles = [];
        let displayedCount = 6;
        const PER_PAGE = 6;
        let currentTipo = 'all';
        let archiveExpanded = false;

        // ── Init ─────────────────────────────────────────────────
        document.addEventListener('DOMContentLoaded', () => {
            fetch('data/articles.json')
                .then(r => r.json())
                .then(data => init(data))
                .catch(() => {
                    // Fallback inline data
                    init([
                        { title: "La Teoría del Rimland y el Nuevo Orden Mundial", description: "Análisis sobre la teoría geopolítica de Nicholas Spykman, el Rimland y la arquitectura del poder contemporáneo.", url: "articles/terapia-liberal-rimland-nuevo-orden-mundial.html", fecha: "07/02/2026", video_id: "9AMPffjQREY", tipo: "video", tags: ["geopolítica", "eeuu", "eurasia", "spykman"] },
                        { title: "GAZA S.A. y VENEZUELA INC.: Así Operan los Arquitectos de la WW3", description: "Investigación sobre cómo Jared Kushner, Tony Blair y megainversores globales transforman conflictos en oportunidades de negocio.", url: "articles/gaza-venezuela-arquitectos-ww3.html", fecha: "08/01/2026", video_id: "9wl8kjn7pV0", tipo: "video", tags: ["geopolítica", "medio oriente", "kushner", "ucrania"] },
                        { title: "Jeffrey: NADA ES LO QUE PARECE", description: "Jeffrey Epstein no era un criminal aislado sino el fixer estratégico de una red global.", url: "articles/jeffrey.html", fecha: "06/12/2025", video_id: "5Kx0Acdv0qw", tipo: "video", tags: ["élites", "wall street", "epstein", "inteligencia"] },
                        { title: "La Matrix del Poder: Quiénes Son los Verdaderos Dueños del Planeta", description: "Las 147 corporaciones que controlan el 40% de la riqueza global.", url: "articles/la-matrix-del-poder.html", fecha: "13/11/2025", video_id: "wsVwjy3z0KE", tipo: "video", tags: ["élites", "oligarquía", "reino unido", "rothschild"] },
                        { title: "El MUNDO se FRACTURA: La Batalla por los Recursos Tecnológicos", description: "La guerra económica por minerales críticos y semiconductores.", url: "articles/el-mundo-se-fractura-recursos-tecnologicos.html", fecha: "07/11/2025", video_id: "mQX6Ef5QwMk", tipo: "video", tags: ["economía", "china", "tecnología"] },
                        { title: "Cometa 3I/ATLAS: ¿Ritual de Élites o Amenaza Real?", description: "Investigación sobre las conexiones entre el cometa ATLAS, Peter Thiel y Palantir.", url: "articles/cometa_atlas_ritual_elites_analisis.html", fecha: "29/10/2025", video_id: "0KJOpBufUc4", tipo: "video", tags: ["tecnología", "espacio", "thiel", "palantir"] },
                        { title: "El Gran Reseteo de la Deuda Mundial", description: "Análisis de la crisis de deuda global y el Great Reset.", url: "articles/analisis_great_reset_deuda_mundial.html", fecha: "24/10/2025", video_id: "a9gcaF--yfk", tipo: "video", tags: ["economía", "deuda", "great reset"] },
                        { title: "El Asesinato de Charlie Kirk", description: "Análisis profundo del fracturamiento del discurso político estadounidense.", url: "articles/analisis_charlie_kirk_2025.html", fecha: "24/10/2025", video_id: "GMTSm7ycs8E", tipo: "video", tags: ["política", "eeuu", "media"] },
                        { title: "La Lucha por la Supremacía de la IA", description: "Cómo la carrera por la inteligencia artificial redefine el poder global.", url: "articles/analisis_supremacia_ia_geopolitica.html", fecha: "15/10/2025", video_id: "-n6Ms6E2tGg", tipo: "video", tags: ["tecnología", "ia", "china"] },
                        { title: "Caos Programado: El Camino hacia una Crisis Total", description: "Análisis del plan tecnocrático detrás del caos aparente en Estados Unidos.", url: "articles/caos-programado-crisis-total.html", fecha: "10/10/2025", video_id: "ZeZN8skPVZg", tipo: "video", tags: ["tecnocracia", "eeuu", "thiel"] },
                        { title: "El Avance de la Tecnocracia Digital", description: "El sistema de identificación digital obligatorio y la vigilancia global.", url: "articles/analisis_tecnocracia_digital.html", fecha: "08/10/2025", video_id: "LqkHZWvALJ8", tipo: "video", tags: ["tecnocracia", "vigilancia"] },
                        { title: "Wall Street Advierte: 'Primero un Gran Repunte, Luego un Crash'", description: "Las advertencias y el paralelismo histórico con 1929.", url: "articles/wall-street-repunte-crash-analisis.html", fecha: "03/10/2025", video_id: "k40I-u2gi50", tipo: "video", tags: ["economía", "wall street", "crash"] },
                        { title: "La División del Mundo en Bloques", description: "La división del mundo en bloques económicos y la reestructuración de la gobernanza mundial.", url: "articles/divideyconquista.html", fecha: "01/10/2025", video_id: "3nfqpb2RLNU", tipo: "video", tags: ["geopolítica", "bloques", "china"] },
                        { title: "El Cuarto Giro: Ciclos Históricos y Crisis Institucional", description: "Análisis de la teoría del Cuarto Giro de Strauss-Howe aplicada al contexto actual.", url: "articles/cuarto-giro.html", fecha: "31/08/2025", video_id: "Bx6zBh7gunI", tipo: "video", tags: ["historia", "ciclos", "crisis"] },
                        { title: "Trump Activa Poderes de Emergencia: COG y Proyecto 2025", description: "Análisis sobre la activación de poderes presidenciales extraordinarios.", url: "articles/trump-poderes-emergencia-cog-proyecto-2025.html", fecha: "20/08/2025", video_id: "hjuWL_z9Vh0", tipo: "video", tags: ["política", "trump", "cog"] },
                        { title: "El Gran Tablero Mundial: La Profecía de Brzezinski", description: "Análisis definitivo de la visión geopolítica de Zbigniew Brzezinski.", url: "articles/zbig.html", fecha: "18/08/2025", video_id: "QTDXeE8bey0", tipo: "video", tags: ["geopolítica", "brzezinski", "eurasia"] },
                        { title: "LOS DUEÑOS DE MAGA y el FUTURO", description: "Investigación sobre los dueños de MAGA y las proyecciones futuras.", url: "articles/dueños-maga.html", fecha: "07/08/2025", video_id: "-wntkT1oDS4", tipo: "video", tags: ["política", "maga", "trump"] },
                        { title: "TRUMP ES el Caballo de Troya Tecnocrático", description: "La verdadera naturaleza del movimiento Trump.", url: "articles/trump-cbdc.html", fecha: "24/07/2025", video_id: "UEgEIzZ9dYo", tipo: "video", tags: ["economía", "cbdc", "trump"] },
                        { title: "El Gran Tablero Geopolítico - Brzezinski marca el Rumbo", description: "La estrategia geopolítica de Zbigniew Brzezinski y su influencia en el orden mundial actual.", url: "articles/el-gran-tablero.html", fecha: "05/07/2025", video_id: "QTDXeE8bey0", tipo: "video", tags: ["geopolítica", "brzezinski", "china"] },
                        { title: "Los Ganadores del Nuevo Complejo Militar TECNOLÓGICO", description: "El entramado entre Silicon Valley, Wall Street y el complejo militar global.", url: "articles/nuevo-complejo-militar.html", fecha: "29/06/2025", video_id: "k3mX98Xo_qc", tipo: "video", tags: ["militar", "tecnología", "blackrock"] },
                        { title: "El Segundo Borrador del Orden Mundial", description: "Rediseño del orden financiero global, geopolítica, CBDC y nueva arquitectura del poder.", url: "articles/seunda-globalizacion.html", fecha: "25/06/2025", video_id: "zYV-hGwE-RQ", tipo: "video", tags: ["geopolítica", "orden mundial", "cbdc"] },
                        { title: "Epstein Inmersivo: La Red Global de Control", description: "Análisis profundo de la red de control global vinculada a Jeffrey Epstein.", url: "articles/epsteininmersivo.html", fecha: "15/06/2025", video_id: "5Kx0Acdv0qw", tipo: "video", tags: ["élites", "epstein", "maxwell"] }
                    ]);
                });
        });

        function init(data) {
            allArticles = [...data].sort((a, b) => {
                const da = new Date((a.fecha || '01/01/2025').split('/').reverse().join('-'));
                const db = new Date((b.fecha || '01/01/2025').split('/').reverse().join('-'));
                return db - da;
            });
            filteredArticles = [...allArticles];
            renderAll();
        }

        function renderAll() {
            renderFeatured();
            renderGrid();
            renderArchive();
            renderTags();
            updateCount();
        }

        // ── Featured ─────────────────────────────────────────────
        function renderFeatured() {
            const container = document.getElementById('featured-container');
            if (!container || filteredArticles.length === 0) return;

            const a = filteredArticles[0];
            const img = a.image || (a.video_id ? `https://img.youtube.com/vi/${a.video_id}/maxresdefault.jpg` : '');
            const youtubeUrl = a.video_id ? `https://youtu.be/${a.video_id}` : '';

            container.innerHTML = `
                <div class="featured-thumb" style="cursor:${youtubeUrl ? 'pointer' : 'default'}" ${youtubeUrl ? `onclick="window.open('${youtubeUrl}','_blank')"` : ''}>
                    ${img ? `<img src="${img}" alt="${a.title}" style="width:100%;height:100%;object-fit:cover;" onerror="this.src='https://img.youtube.com/vi/${a.video_id}/hqdefault.jpg'">` : `<div style="width:100%;height:100%;background:#111;display:flex;align-items:center;justify-content:center;min-height:280px;"><i class="fas fa-file-alt" style="font-size:3rem;color:#333;"></i></div>`}
                    ${youtubeUrl ? `
                    <div style="position:absolute;inset:0;background:rgba(0,0,0,0.35);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.3s;" class="featured-play-overlay">
                        <div style="width:70px;height:70px;border-radius:50%;background:rgba(0,0,0,0.8);border:3px solid var(--gold);display:flex;align-items:center;justify-content:center;">
                            <i class="fas fa-play" style="color:var(--gold);font-size:1.5rem;margin-left:4px;"></i>
                        </div>
                    </div>` : ''}
                    <span style="position:absolute;top:12px;left:12px;background:${a.tipo === 'video' ? 'var(--red)' : 'var(--gold)'};color:${a.tipo === 'video' ? 'white' : '#000'};padding:4px 12px;border-radius:20px;font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;">
                        ${a.tipo === 'video' ? '<i class="fab fa-youtube mr-1"></i>Video' : '<i class="fas fa-file-alt mr-1"></i>Artículo'}
                    </span>
                </div>
                <div class="featured-body">
                    <span class="featured-label">
                        <i class="fas fa-star"></i> Análisis Destacado
                    </span>
                    <span style="display:inline-block;background:linear-gradient(135deg,var(--gold),var(--gold-light));color:#000;padding:3px 10px;border-radius:20px;font-size:0.7rem;font-weight:600;margin-bottom:0.75rem;">${a.fecha}</span>
                    <h3 class="featured-title">${a.title}</h3>
                    <p class="featured-desc">${a.description}</p>
                    <div class="featured-actions">
                        <a href="${a.url}" class="card-btn card-btn-outline">
                            <i class="fas fa-arrow-right"></i> Leer Análisis
                        </a>
                        ${youtubeUrl ? `
                        <a href="${youtubeUrl}" target="_blank" rel="noopener noreferrer" class="card-btn card-btn-primary">
                            <i class="fab fa-youtube"></i> Ver Video
                        </a>` : ''}
                    </div>
                </div>
            `;

            // Hover effect on featured play overlay
            const thumb = container.querySelector('.featured-thumb');
            const overlay = container.querySelector('.featured-play-overlay');
            if (thumb && overlay) {
                thumb.addEventListener('mouseenter', () => overlay.style.opacity = '1');
                thumb.addEventListener('mouseleave', () => overlay.style.opacity = '0');
            }
        }

        // ── Grid ─────────────────────────────────────────────────
        function renderGrid() {
            const container = document.getElementById('grid-container');
            if (!container) return;

            const articles = filteredArticles.slice(1, displayedCount + 1);

            if (articles.length === 0) {
                container.innerHTML = `
                    <div style="grid-column:1/-1;text-align:center;padding:4rem 0;">
                        <i class="fas fa-search" style="font-size:3rem;color:#333;margin-bottom:1rem;display:block;"></i>
                        <p style="color:var(--text-muted);font-size:1.1rem;">No se encontraron artículos</p>
                    </div>`;
                document.getElementById('load-more-btn').style.display = 'none';
                return;
            }

            container.innerHTML = articles.map((a, i) => {
                const img = a.image || (a.video_id ? `https://img.youtube.com/vi/${a.video_id}/hqdefault.jpg` : '');
                const isVideo = !!a.video_id;
                const youtubeUrl = isVideo ? `https://youtu.be/${a.video_id}` : '';
                const tipoClass = a.tipo === 'video' ? 'video' : 'articulo';
                const tipoLabel = a.tipo === 'video' ? 'Video' : 'Artículo';

                return `
                <article class="article-card" style="animation-delay:${i * 0.08}s">
                    <a href="${a.url}" class="card-thumb-link" style="display:block;text-decoration:none;border:none;">
                        <div class="card-thumb">
                            ${img
                                ? `<img src="${img}" alt="${a.title}" loading="lazy" onerror="this.src='https://img.youtube.com/vi/${a.video_id || ''}/hqdefault.jpg'">`
                                : `<div style="width:100%;height:100%;background:#111;display:flex;align-items:center;justify-content:center;"><i class="fas fa-file-alt" style="font-size:2.5rem;color:#333;"></i></div>`
                            }
                            <span class="card-badge ${tipoClass}">
                                ${isVideo ? '<i class="fab fa-youtube mr-1"></i>' : '<i class="fas fa-file-alt mr-1"></i>'}${tipoLabel}
                            </span>
                            ${isVideo ? `<div class="play-overlay"><i class="fas fa-play"></i></div>` : ''}
                        </div>
                    </a>
                    <div class="card-body">
                        <span class="date-badge">${a.fecha}</span>
                        <h4 class="card-title">
                            <a href="${a.url}" style="color:inherit;text-decoration:none;border:none;">${a.title}</a>
                        </h4>
                        <p class="card-desc">${a.description}</p>
                        ${a.tags && a.tags.length > 0 ? `
                        <div class="card-tags">
                            ${a.tags.slice(0, 3).map(t => `<span>#${t}</span>`).join('')}
                        </div>` : ''}
                        <div class="card-actions">
                            ${isVideo ? `
                            <a href="${youtubeUrl}" target="_blank" rel="noopener noreferrer" class="card-btn card-btn-primary">
                                <i class="fab fa-youtube"></i> Ver Video
                            </a>` : ''}
                            <a href="${a.url}" class="card-btn card-btn-outline">
                                <i class="fas fa-arrow-right"></i> Leer Más
                            </a>
                        </div>
                    </div>
                </article>`;
            }).join('');

            const btn = document.getElementById('load-more-btn');
            btn.style.display = (displayedCount + 1 < filteredArticles.length) ? 'inline-flex' : 'none';
        }

        // ── Archive ───────────────────────────────────────────────
        function renderArchive() {
            const container = document.getElementById('archive-list');
            if (!container) return;

            const items = allArticles.slice(0, 20);
            container.innerHTML = items.map(a => `
                <a href="${a.url}" style="display:block;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.06);text-decoration:none;border-left:none;border-right:none;border-top:none;transition:padding-left 0.2s;">
                    <span style="display:block;font-size:0.7rem;color:var(--gold);margin-bottom:2px;">${a.fecha}</span>
                    <span style="display:block;font-size:0.82rem;color:var(--text-muted);line-height:1.4;">${a.title}</span>
                </a>
            `).join('');

            const toggle = document.getElementById('archive-toggle');
            if (toggle) toggle.style.display = allArticles.length > 20 ? 'block' : 'none';
        }

        function toggleArchive() {
            archiveExpanded = !archiveExpanded;
            const list = document.getElementById('archive-list');
            const toggle = document.getElementById('archive-toggle');
            if (archiveExpanded) {
                list.style.maxHeight = 'none';
                toggle.textContent = 'Ver menos ▲';
            } else {
                list.style.maxHeight = '280px';
                toggle.textContent = 'Ver más ▼';
            }
        }

        // ── Tags ─────────────────────────────────────────────────
        function renderTags() {
            const container = document.getElementById('tags-cloud');
            if (!container) return;

            const tags = [...new Set(allArticles.flatMap(a => a.tags || []))].slice(0, 20);
            container.innerHTML = tags.map(tag => `
                <button onclick="searchArticles('${tag}')" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.08);color:var(--text-muted);padding:4px 10px;border-radius:15px;font-size:0.75rem;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.background='var(--gold)';this.style.color='#000';this.style.borderColor='var(--gold)';" onmouseout="this.style.background='rgba(255,255,255,0.05)';this.style.color='var(--text-muted)';this.style.borderColor='rgba(255,255,255,0.08)';">
                    ${tag}
                </button>
            `).join('');
        }

        // ── Filters ───────────────────────────────────────────────
        function filterByTipo(tipo) {
            currentTipo = tipo;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tipo === tipo);
            });
            applyFilters();
        }

        function searchArticles(query) {
            const input = document.getElementById('search-input');
            if (input) input.value = query;
            applyFilters(query.toLowerCase());
        }

        function applyFilters(search = null) {
            const q = search !== null ? search : (document.getElementById('search-input')?.value || '').toLowerCase();
            filteredArticles = allArticles.filter(a => {
                const matchesTipo = currentTipo === 'all' || a.tipo === currentTipo;
                const matchesSearch = !q ||
                    a.title?.toLowerCase().includes(q) ||
                    a.description?.toLowerCase().includes(q) ||
                    a.tags?.some(t => t.toLowerCase().includes(q));
                return matchesTipo && matchesSearch;
            });
            displayedCount = 6;
            renderFeatured();
            renderGrid();
            updateCount();
        }

        function loadMore() {
            displayedCount += PER_PAGE;
            renderGrid();
        }

        function updateCount() {
            const countEl = document.getElementById('article-count');
            const titleEl = document.getElementById('grilla-titulo');
            if (countEl) countEl.textContent = `(${filteredArticles.length})`;
            if (titleEl) {
                titleEl.textContent =
                    currentTipo === 'all' ? 'Todos los Análisis' :
                    currentTipo === 'video' ? 'Videos' : 'Artículos';
            }
        }
    </script>

    <!-- Responsive sidebar -->
    <style>
        @media (max-width: 1024px) {
            #main-layout {
                grid-template-columns: 1fr !important;
            }
            #main-layout aside {
                position: static !important;
            }
        }
        .featured-thumb {
            position: relative;
        }
        .card-thumb-link:hover .play-overlay {
            opacity: 1;
        }
        /* Sidebar archive scrollbar */
        #archive-list::-webkit-scrollbar { width: 4px; }
        #archive-list::-webkit-scrollbar-thumb { background: var(--gold); border-radius: 2px; }
        /* Search input */
        #search-input {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            color: var(--text-body);
            padding: 10px 14px;
            border-radius: 8px;
            width: 100%;
            font-size: 0.9rem;
            transition: border-color 0.3s;
        }
        #search-input:focus {
            outline: none;
            border-color: var(--gold);
        }
        #search-input::placeholder { color: var(--text-muted); }
    </style>

</body>
</html>
