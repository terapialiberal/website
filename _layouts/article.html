<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} | Terapia Liberal</title>
    <meta name="description" content="{% if page.description %}{{ page.description }}{% else %}An√°lisis independiente{% endif %}">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { gold: '#d4af37', red: '#dc2626' }
                }
            }
        }
    </script>

    <style>
        :root { --gold: #d4af37; --red: #dc2626; }

        /* Modo Oscuro */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: #ffffff;
            min-height: 100vh;
            line-height: 1.7;
        }

        /* Modo Claro */
        body.light {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #1a1a1a;
        }

        .gold-text { color: var(--gold); }
        body.light .gold-text { color: #b8962e; }

        .section-bg {
            background: rgba(31, 41, 55, 0.6);
            border: 1px solid rgba(75, 85, 99, 0.4);
        }

        body.light .section-bg {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        /* Header */
        header {
            background: rgba(10, 10, 10, 0.95);
            border-bottom: 1px solid rgba(75, 85, 99, 0.4);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            transition: background 0.3s, border 0.3s;
        }

        body.light header {
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-section .logo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
        }

        .logo-section .brand-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .social-icons a {
            color: #9ca3af;
            font-size: 1.25rem;
            margin-left: 1rem;
            transition: color 0.3s;
        }

        body.light .social-icons a { color: #6b7280; }
        .social-icons a:hover { color: var(--gold); }

        .theme-toggle {
            background: none;
            border: 1px solid #9ca3af;
            color: #9ca3af;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin-left: 1rem;
            transition: all 0.3s;
        }

        body.light .theme-toggle { color: #6b7280; border-color: #6b7280; }
        .theme-toggle:hover { color: var(--gold); border-color: var(--gold); }

        /* Article */
        .article-content h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }

        .article-content h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }

        .article-content p { margin-bottom: 1.25rem; }

        .article-content a { color: var(--gold); text-decoration: underline; }

        .article-content blockquote {
            border-left: 3px solid var(--gold);
            padding-left: 1rem;
            margin: 1.5rem 0;
            font-style: italic;
            color: #9ca3af;
        }

        body.light .article-content blockquote { color: #6b7280; }

        .article-content img { max-width: 100%; border-radius: 12px; margin: 1.5rem 0; }

        .video-embed {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            margin: 2rem 0;
        }

        .video-embed iframe {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            border-radius: 12px;
            border: none;
        }

        .badge {
            background: #374151;
            color: #d1d5db;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-gold {
            background: linear-gradient(135deg, var(--gold), var(--red));
            color: #000;
        }

        .related-card {
            background: #1f2937;
            border: 1px solid #374151;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s;
        }

        body.light .related-card { background: #fff; border-color: #e5e7eb; }
        .related-card:hover { border-color: var(--gold); transform: translateY(-4px); }
        .related-card img { width: 100%; aspect-ratio: 16/9; object-fit: cover; }

        /* Footer */
        footer {
            background: rgba(10, 10, 10, 0.95);
            border-top: 1px solid rgba(75, 85, 99, 0.4);
            padding: 3rem 2rem;
            margin-top: 4rem;
            text-align: center;
            transition: background 0.3s, border 0.3s;
        }

        body.light footer {
            background: rgba(255, 255, 255, 0.95);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .footer-social {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
        }

        .footer-social a {
            color: #9ca3af;
            font-size: 1.5rem;
            transition: color 0.3s;
        }

        body.light .footer-social a { color: #6b7280; }
        .footer-social a:hover { color: var(--gold); }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: #9ca3af;
            font-size: 0.9rem;
            transition: color 0.3s;
        }

        body.light .footer-links a { color: #6b7280; }
        .footer-links a:hover { color: var(--gold); }

        /* Back to top */
        #backToTop {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--gold), var(--red));
            color: #000;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.25rem;
            display: none;
            z-index: 1000;
        }

        #backToTop.show { display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body class="dark">
    <!-- Header -->
    <header>
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="logo-section">
                <img src="https://yt3.googleusercontent.com/ZzVyDrXt4x8YWoKbISHZzC9CCtkEPCN4GRET1Xxf_wssNyw7mfN-xTbBmpwEJHO0DRQrg0Dgug=s900-c-k-c0x00ffffff-no-rj" alt="Logo" class="logo">
                <a href="/" class="brand-title">Terapia Liberal</a>
            </div>
            <div class="flex items-center">
                <nav class="social-icons">
                    <a href="https://www.youtube.com/@terapialiberal" target="_blank"><i class="fab fa-youtube"></i></a>
                    <a href="https://x.com/terapia_liberal" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="https://www.patreon.com/terapialiberal" target="_blank"><i class="fab fa-patreon"></i></a>
                </nav>
                <button class="theme-toggle" onclick="toggleTheme()" title="Cambiar tema">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Article -->
    <main class="max-w-4xl mx-auto px-6 py-12">
        <!-- Volver -->
        <a href="/" class="inline-flex items-center gap-2 text-gray-500 hover:text-gold mb-8">
            <i class="fas fa-arrow-left"></i> Volver al inicio
        </a>

        <!-- Header -->
        <header class="mb-10 border-b border-gray-800 pb-8">
            <div class="flex items-center gap-3 mb-4 flex-wrap">
                <span class="badge badge-gold">{% if page.featured %}‚≠ê Destacado{% else %}{% if page.tipo == 'video' %}üé¨ Video{% else %}üìù Art√≠culo{% endif %}{% endif %}</span>
                <span class="text-gray-500 text-sm">{{ page.date | date: "%d/%m/%Y" }}</span>
            </div>
            <h1 class="text-3xl md:text-4xl font-bold mb-4">{{ page.title }}</h1>
            <p class="text-xl text-gray-400 mb-6">{% if page.description %}{{ page.description }}{% endif %}</p>
            <div class="flex items-center gap-3">
                <img src="https://i.postimg.cc/8C3ZkxNy/1660176107980.jpg" alt="Nicol√°s" class="w-12 h-12 rounded-full ring-2 ring-gold/30">
                <div>
                    <p class="font-medium">Nicol√°s Mart√≠nez Lage</p>
                    <p class="text-gray-500 text-sm">Analista Independiente</p>
                </div>
            </div>
        </header>

        <!-- Video -->
        {% if page.video_id %}
        <div class="mb-10">
            <div class="video-embed">
                <iframe src="https://www.youtube.com/embed/{{ page.video_id }}" title="{{ page.title }}" allowfullscreen></iframe>
            </div>
        </div>
        {% endif %}

        <!-- Image -->
        {% if page.image %}
        <div class="mb-10">
            <img src="{{ page.image }}" alt="{{ page.title }}" class="w-full rounded-xl">
        </div>
        {% endif %}

        <!-- Content -->
        <div class="article-content">
            {{ content }}
        </div>

        <!-- Tags -->
        {% if page.tags %}
        <div class="mt-10 pt-8 border-t border-gray-800">
            <p class="text-gray-500 text-sm mb-3">Etiquetas:</p>
            <div class="flex flex-wrap gap-2">
                {% for tag in page.tags %}
                <span class="badge">{{ tag }}</span>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Share -->
        <div class="mt-10 pt-8 border-t border-gray-800">
            <p class="text-gray-500 text-sm mb-4">Compartir:</p>
            <div class="flex gap-4">
                <a href="https://twitter.com/intent/tweet?text={{ page.title }}&url={{ page.url | absolute_url }}" target="_blank" class="text-gray-500 hover:text-gold text-xl"><i class="fab fa-x-twitter"></i></a>
                <a href="https://www.facebook.com/sharer/sharer.php?u={{ page.url | absolute_url }}" target="_blank" class="text-gray-500 hover:text-gold text-xl"><i class="fab fa-facebook"></i></a>
                <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ page.url | absolute_url }}&title={{ page.title }}" target="_blank" class="text-gray-500 hover:text-gold text-xl"><i class="fab fa-linkedin"></i></a>
                <a href="https://wa.me/?text={{ page.title }} - {{ page.url | absolute_url }}" target="_blank" class="text-gray-500 hover:text-gold text-xl"><i class="fab fa-whatsapp"></i></a>
            </div>
        </div>

        <!-- Related -->
        <div class="mt-12 pt-8 border-t border-gray-800">
            <h3 class="text-xl font-bold mb-6 gold-text">Art√≠culos Relacionados</h3>
            <div class="grid md:grid-cols-3 gap-4" id="related-articles"></div>
        </div>

        <!-- Back to home -->
        <div class="mt-10 text-center">
            <a href="/" class="btn-gradient inline-flex items-center gap-2">
                <i class="fas fa-home"></i> Volver al inicio
            </a>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-links">
            <a href="/"><i class="fas fa-home mr-2"></i>Inicio</a>
            <a href="https://www.youtube.com/@terapialiberal" target="_blank"><i class="fab fa-youtube mr-2"></i>YouTube</a>
            <a href="https://x.com/terapia_liberal" target="_blank"><i class="fa-brands fa-x-twitter mr-2"></i>Twitter/X</a>
            <a href="https://www.patreon.com/terapialiberal" target="_blank"><i class="fab fa-patreon mr-2"></i>Patreon</a>
            <a href="/admin/"><i class="fas fa-cog mr-2"></i>Admin</a>
        </div>
        <div class="footer-social">
            <a href="https://www.youtube.com/@terapialiberal" target="_blank"><i class="fab fa-youtube"></i></a>
            <a href="https://x.com/terapia_liberal" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
            <a href="https://www.patreon.com/terapialiberal" target="_blank"><i class="fab fa-patreon"></i></a>
        </div>
        <p class="text-gray-500 text-sm">¬© 2026 Terapia Liberal. An√°lisis independiente para mentes cr√≠ticas.</p>
    </footer>

    <button id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})"><i class="fas fa-arrow-up"></i></button>

    <script>
        // Theme toggle
        function toggleTheme() {
            const body = document.body;
            const icon = document.querySelector('.theme-toggle i');

            if (body.classList.contains('dark')) {
                body.classList.remove('dark');
                body.classList.add('light');
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.remove('light');
                body.classList.add('dark');
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
                localStorage.setItem('theme', 'dark');
            }
        }

        // Cargar tema guardado
        (function() {
            if (localStorage.getItem('theme') === 'light') {
                document.body.classList.remove('dark');
                document.body.classList.add('light');
                document.querySelector('.theme-toggle i').classList.replace('fa-moon', 'fa-sun');
            }
        })();

        // Back to top
        window.addEventListener('scroll', () => {
            document.getElementById('backToTop').classList.toggle('show', window.pageYOffset > 300);
        });

        // Related articles
        const currentTipo = "{{ page.tipo }}";
        const currentUrl = "{{ page.url }}";

        fetch('/data/articles.json')
            .then(res => res.json())
            .then(articles => {
                let related = articles.filter(a => a.tipo === currentTipo && a.url !== currentUrl).slice(0, 3);
                if (related.length < 3) {
                    const others = articles.filter(a => a.url !== currentUrl && !related.includes(a)).slice(0, 3 - related.length);
                    related = [...related, ...others];
                }

                if (related.length > 0) {
                    document.getElementById('related-articles').innerHTML = related.map(a => {
                        const img = a.image || (a.video_id ? `https://img.youtube.com/vi/${a.video_id}/mqdefault.jpg` : '');
                        return `<a href="${a.url}" class="related-card block">
                            <img src="${img}" alt="${a.title}" loading="lazy">
                            <div class="p-3">
                                <span class="text-gray-500 text-xs">${a.fecha || ''}</span>
                                <h4 class="font-bold text-sm mt-1 line-clamp-2">${a.title}</h4>
                            </div>
                        </a>`;
                    }).join('');
                }
            });
    </script>
</body>
</html>
